<div class="overflow-x-auto">
  <p-table
    [value]="users"
    [tableStyle]="{ 'min-width': '50rem' }"
    editMode="row"
    dataKey="id"
    [paginator]="true"
    [rows]="5"
    [rowsPerPageOptions]="[5, 10, 20]"
  >
    <ng-template pTemplate="header">
      <tr>
        @for (header of tableHeaders; track $index) {
          <th>{{ header }}</th>
        }
      </tr>
    </ng-template>

    <ng-template
      pTemplate="body"
      let-user
      let-editing="editing"
      let-ri="rowIndex"
    >
      <tr [pEditableRow]="user" (click)="navigateToUser(user.id)">
        <td>{{ ri + 1 }}</td>
        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="user.first_name"
                [ngModelOptions]="{ standalone: true }"
                class="max-w-[150px]"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ user.first_name }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="user.last_name"
                [ngModelOptions]="{ standalone: true }"
                class="max-w-[150px]"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ user.last_name }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="email"
                [(ngModel)]="user.email"
                [ngModelOptions]="{ standalone: true }"
                class="max-w-[150px]"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ user.email }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <p-datepicker
                [(ngModel)]="user.dob"
                [ngModelOptions]="{ standalone: true }"
                dateFormat="dd/mm/yy"
                [showIcon]="true"
                class="max-w-[150px]"
              ></p-datepicker>
            </ng-template>
            <ng-template pTemplate="output">
              {{ user.dob | formatDate }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="user.interests"
                [ngModelOptions]="{ standalone: true }"
                class="max-w-[150px]"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ user.interests }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td class="flex justify-between">
          @if (!editing) {
            <button
              pButton
              pRipple
              type="button"
              pInitEditableRow
              icon="pi pi-pencil"
              (click)="onRowEditInit(user)"
              class="p-button-rounded p-button-text"
            >
              Update
            </button>
            <button
              pButton
              pRipple
              type="button"
              icon="pi pi-trash"
              (click)="deleteUser(user.id)"
              class="p-button-rounded p-button-text p-button-danger"
            >
              Delete
            </button>
          }
          @if (editing) {
            <button
              pButton
              pRipple
              type="button"
              pSaveEditableRow
              icon="pi pi-check"
              (click)="onRowEditSave(user)"
              class="p-button-rounded p-button-text p-button-success"
            >
              Save
            </button>
            <button
              pButton
              pRipple
              type="button"
              pCancelEditableRow
              icon="pi pi-times"
              (click)="onRowEditCancel(user)"
              class="p-button-rounded p-button-text p-button-danger"
            >
              Cancel
            </button>
          }
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7" class="text-center">No users found</td>
      </tr>
    </ng-template>
  </p-table>
</div>
